# Prompt: MGnNegativeRCSCalc — upward transitions on negative arrival (n=3, levels 0..4)

Use this prompt in a diffusion/image model (e.g., GPT Image / Nano-banana) to generate a transition diagram.

---

Сгенерируй **векторную** диаграмму переходов между микросостояниями для модели **M/H2/3 с отрицательными заявками (RCS: remove customer from service)**.

## Единый стиль серии (применить строго)

- Фон: **белый или прозрачный**.
- Стиль: **flat vector**, аккуратный “учебниковый” вид, но **красочный**.
- Цветовая логика: **цвет задаётся ярусом** (один ярус = один цвет), одинаково во всей серии:
  - Ярус 0: пастельный голубой
  - Ярус 1: пастельный бирюзовый
  - Ярус 2: пастельный фиолетовый
  - Ярус 3: пастельный оранжевый
  - Ярус 4: пастельный розовый
- Узлы-состояния: **одинаковые** прямоугольники со слегка скруглёнными углами; тонкий тёмный контур; светлая заливка.
- Подписи состояний: моноширинный или очень читаемый шрифт; центрирование текста; размер одинаковый на всех узлах.
- Стрелки: одинаковая толщина; аккуратные наконечники; подпись над/рядом со стрелкой.
- Математика: подписи вида \(\delta\), \(\delta\cdot\frac{2}{3}\) — именно дробями; без десятичных.
- Не добавлять заголовки сверху и легенды/пояснения снизу (только то, что явно требуется: номера ярусов слева, подписи состояний и подписи на стрелках).
- Компоновка: **широкий холст** (ландшафт, много места по ширине), большие поля; расстояния между узлами на ярусах 3 и 4 увеличить, чтобы подписи не слипались.
- Подписи на стрелках: размещай в небольших **белых полупрозрачных плашках** со скруглением (label callouts), чтобы текст читался поверх линий; не допускать наложений.

**Разметка ярусов (нужно 5 ярусов: 0, 1, 2, 3, 4):**
- Ярус 0: состояние **00**
- Ярус 1: состояния **10**, **01**
- Ярус 2: состояния **20**, **11**, **02**
- Ярус 3: состояния **30**, **21**, **12**, **03**
- Ярус 4: состояния **30**, **21**, **12**, **03** (на этом ярусе все 3 прибора заняты, плюс 1 заявка в очереди)

**Кодировка микросостояния — ровно 2 цифры** `ab`, где:
- \(a\) = число приборов в фазе \(\mu_1\),
- \(b\) = число приборов в фазе \(\mu_2\),
- \(a+b=k\).
Обязательно показывай **ведущий ноль**: **03**, **02**, **01**, **00**.

Нарисуй **ТОЛЬКО переходы “вверх” (уменьшение уровня на 1) по событию прихода отрицательной заявки** с интенсивностью \( \delta \).

Отрицательная заявка **равновероятно выбирает один из занятых приборов**.

Для ярусов 1, 2, 3 (где занято \(k\) приборов и очереди нет) интенсивности переходов из состояния `ab`:

- `ab` \(\to\) `(a-1)b` с подписью на стрелке:  \( \delta \cdot \frac{a}{k} \)
- `ab` \(\to\) `a(b-1)` с подписью на стрелке:  \( \delta \cdot \frac{b}{k} \)

**Критично:** подписи должны быть **именно дробями**, не десятичными (например \( \delta\cdot\frac{2}{3} \), \( \delta\cdot\frac{1}{2} \)).
Если множитель равен 1 (например \(\frac{1}{1}\), \(\frac{2}{2}\), \(\frac{3}{3}\)), то на стрелке пиши **просто** \( \delta \) без дроби.

**Явно прорисуй все стрелки для \(k=3\to2\), \(k=2\to1\), \(k=1\to0\):**
- 30→20: \( \delta \)
- 21→11: \( \delta\cdot\frac{2}{3} \); 21→20: \( \delta\cdot\frac{1}{3} \)
- 12→02: \( \delta\cdot\frac{1}{3} \); 12→11: \( \delta\cdot\frac{2}{3} \)
- 03→02: \( \delta \)

- 20→10: \( \delta \)
- 11→01: \( \delta\cdot\frac{1}{2} \); 11→10: \( \delta\cdot\frac{1}{2} \)
- 02→01: \( \delta \)

- 10→00: \( \delta \)
- 01→00: \( \delta \)

### Переходы с яруса 4 на ярус 3 (важно: здесь появляется \(y_1,y_2\))

На ярусе 4 заняты все 3 прибора и 1 заявка в очереди. При отрицательной заявке один прибор “сбрасывается”, а заявка из очереди **сразу** занимает освободившийся прибор и запускается в фазу:
- с вероятностью \(y_1\) в фазу \(\mu_1\),
- с вероятностью \(y_2\) в фазу \(\mu_2\),
где \(y_1+y_2=1\).

Нарисуй **строго** следующие переходы (все подписи — дробями; где множитель 1, писать просто \(\delta\)):

- 30(ярус 4) → 30(ярус 3): \( \delta\cdot y_1 \)
- 30(ярус 4) → 21(ярус 3): \( \delta\cdot y_2 \)

- 21(ярус 4) → 30(ярус 3): \( \delta\cdot\frac{1}{3}\cdot y_1 \)
- 21(ярус 4) → 21(ярус 3): \( \delta\cdot\left(\frac{2}{3}\cdot y_1 + \frac{1}{3}\cdot y_2\right) \)
- 21(ярус 4) → 12(ярус 3): \( \delta\cdot\frac{2}{3}\cdot y_2 \)

- 12(ярус 4) → 21(ярус 3): \( \delta\cdot\frac{2}{3}\cdot y_1 \)
- 12(ярус 4) → 12(ярус 3): \( \delta\cdot\left(\frac{1}{3}\cdot y_1 + \frac{2}{3}\cdot y_2\right) \)
- 12(ярус 4) → 03(ярус 3): \( \delta\cdot\frac{1}{3}\cdot y_2 \)

- 03(ярус 4) → 12(ярус 3): \( \delta\cdot y_1 \)
- 03(ярус 4) → 03(ярус 3): \( \delta\cdot y_2 \)

**Композиция/геометрия:**
- Расположи ярусы вертикально (сверху ярус 0, снизу ярус 4), чтобы стрелки шли **вверх**.
- Слева от каждого яруса укажи только номер яруса: **0**, **1**, **2**, **3**. Не пиши `k = 0` и вообще не используй `k = ...` в подписях ярусов.
- Добавь также номер яруса **4** слева.
- Внутри яруса состояния расположи слева направо по возрастанию \(b\): например на ярусе 3 и 4: 30, 21, 12, 03.
- Стрелки делай диагональными так, чтобы было понятно, к какому состоянию ведут (как на классических треугольных диаграммах переходов).
- Важное требование к читаемости: на ярусе 4 сделай узлы **чуть шире** и разнеси сильнее по горизонтали; подписи на стрелках разнеси и при необходимости используй **перенос строки** внутри плашки.

#### Негативные требования (чтобы не испортилось)
Не рисуй другие переходы (ни \(\mu_1,\mu_2\), ни \(\lambda_{+}\)), не добавляй лишних состояний, не заменяй дроби десятичными, не добавляй заголовок сверху, не добавляй приписки/легенду/текст снизу (кроме подписей на стрелках и номеров ярусов слева).

